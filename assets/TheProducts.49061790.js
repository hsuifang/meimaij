var J=Object.defineProperty,X=Object.defineProperties;var Y=Object.getOwnPropertyDescriptors;var E=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,Q=Object.prototype.propertyIsEnumerable;var F=(i,l,c)=>l in i?J(i,l,{enumerable:!0,configurable:!0,writable:!0,value:c}):i[l]=c,P=(i,l)=>{for(var c in l||(l={}))Z.call(l,c)&&F(i,c,l[c]);if(E)for(var c of E(l))Q.call(l,c)&&F(i,c,l[c]);return i},T=(i,l)=>X(i,Y(l));import{J as N,r as V,c as D,R as L,q as R,X as W,Y as tt,o as k,a as x,b as t,t as I,G as et,n as q,w as m,v as g,f as s,F as ot,e as at,Z as st,j as M,$ as j,d as lt,g as A,a0 as z,a1 as G,C as K,h as S,y as w,a2 as nt,a3 as it,D as dt}from"./index.365780fe.js";import{_ as ct}from"./AppTable.94f2fead.js";const rt=["id"],ut={class:"modal-content border-0"},mt={class:"modal-header bg-primary p-3 text-white"},pt={class:"modal-body p-4"},bt={__name:"AppModal",props:{modelValue:Boolean,title:String,refName:String,size:{type:String,validator:i=>["sm","md","lg","xl"].indexOf(i)!==-1,default:"lg"}},emits:["update:modelValue"],setup(i,{emit:l}){const c=i;let _=N({info:{}});const p=V(null),e=D({get(){return c.modelValue},set(u){l("update:modelValue",u)}}),f=u=>{u?_.info.show():_.info.hide()};return L(()=>c.modelValue,u=>{f(u)}),R(()=>{_.info=W(p.value)}),tt(()=>{_.info={}}),(u,n)=>(k(),x("div",{id:i.refName,class:"modal fade show",ref_key:"modalName",ref:p,"data-bs-backdrop":"static","data-bs-focus":"false","data-bs-keyboard":"false"},[t("div",{class:q(["modal-dialog modal-dialog-centered",`modal-${i.size}`])},[t("div",ut,[t("div",mt,[t("p",null,I(i.title),1),t("button",{type:"button",class:"btn-close text-white me-1",onClick:n[0]||(n[0]=o=>e.value=!1)})]),t("div",pt,[et(u.$slots,"default")])])],2)],8,rt))}};const _t=["onSubmit"],ft=t("div",{class:"col-md-7"},[t("p",null,"\u5716\u7247\u66F4\u65B0\u5340")],-1),ht={class:"col-md-5"},gt={class:"row align-items-end"},vt={class:"mb-3"},yt=t("label",{for:"title",class:"form-label"},"\u7522\u54C1\u540D\u7A31",-1),wt={class:"mb-3"},kt=t("label",{class:"form-label"},"\u72C0\u614B",-1),xt={class:"d-flex"},It=["value","id"],$t=["for"],Pt={class:"mb-3"},Vt=t("label",{for:"description",class:"form-label"},"\u63CF\u8FF0",-1),Ct={class:"mb-3"},Ut=t("label",{for:"content",class:"form-label"},"\u5167\u5BB9",-1),St={class:"mb-3"},Nt=t("label",{for:"spec",class:"form-label"},"\u898F\u683C",-1),Mt={class:"col-md-6 mb-3"},Bt=t("label",{for:"originPrice",class:"form-label"},"\u539F\u50F9",-1),Et={class:"col-md-6 mb-3"},Ft=t("label",{for:"price",class:"form-label"},"\u552E\u50F9",-1),Tt={class:"col-md-4 mb-3"},jt=t("label",{for:"category",class:"form-label"},"\u985E\u5225",-1),At={class:"col-md-4 mb-3"},Dt=t("label",{for:"unit",class:"form-label"},"\u55AE\u4F4D",-1),Lt={class:"col-md-4 mb-3"},Rt={class:"form-check"},qt=t("label",{class:"form-check-label",for:"isEnabled"}," \u555F\u7528 ",-1),zt={class:"col-md-8 mb-3"},Gt={for:"rate",class:"form-label"},Kt={class:"col-md-4 mb-3"},Ot={class:"form-check"},Ht=t("label",{class:"form-check-label",for:"isRateEnabled"}," \u986F\u793A\u8A55\u50F9 ",-1),Jt={class:"col-12"},Xt=["disabled"],Yt={__name:"ProductItemForm",props:{isCreate:{type:Boolean},productItem:{type:Object}},emits:["clearItem","submitProductItem"],setup(i,{emit:l}){const c=i,{toggleLoading:_}=K();let p=[{id:1,type:"danger",name:"\u71B1\u9580",value:"\u71B1\u9580"},{id:2,type:"warning",name:"\u65B0\u4E0A\u5E02",value:"\u65B0\u4E0A\u5E02"},{id:3,type:"info",name:"\u4E0D\u986F\u793A",value:""}],e=V({});const f=async()=>{try{_(!0);const n=e.value,o=n.id?await G({id:n.id,data:{data:n}}):await z({data:n}),{success:a}=o.data;a&&l("submitProductItem")}catch{}_(!1)},u=D(()=>["title","category","unit","origin_price","price"].every(o=>e.value[o]));return L(()=>c.productItem,n=>{e.value=P({},n)}),R(()=>{e.value=P({},c.productItem)}),(n,o)=>(k(),x("form",{onSubmit:A(f,["prevent"])},[t("div",{onKeydown:o[12]||(o[12]=lt(A(()=>{},["stop"]),["enter"])),class:"row g-4"},[ft,t("div",ht,[t("div",gt,[t("div",vt,[yt,m(t("input",{type:"text",class:"form-control",id:"title","onUpdate:modelValue":o[0]||(o[0]=a=>s(e).title=a)},null,512),[[g,s(e).title]])]),t("div",wt,[kt,t("ul",xt,[(k(!0),x(ot,null,at(s(p),a=>(k(),x("li",{class:"me-3",key:a.id},[m(t("input",{type:"radio",name:"checkedStatus",class:"me-1 position-absolute opacity-0",value:a.value,id:`${a.type}Status`,"onUpdate:modelValue":o[1]||(o[1]=C=>s(e).statusType=C)},null,8,It),[[st,s(e).statusType]]),t("label",{for:`${a.type}Status`,class:"checkedStatus--checked"},[t("span",{style:{width:"10px",height:"10px"},class:q(["d-inline-block rounded-circle me-1",`bg-${a.type}`])},null,2),M(" "+I(a.name),1)],8,$t)]))),128))])]),t("div",Pt,[Vt,m(t("textarea",{class:"form-control",id:"description",placeholder:"\u63CF\u8FF0",row:"5","onUpdate:modelValue":o[2]||(o[2]=a=>s(e).description=a)},null,512),[[g,s(e).description]])]),t("div",Ct,[Ut,m(t("textarea",{class:"form-control",id:"content",placeholder:"\u5167\u5BB9",row:"5","onUpdate:modelValue":o[3]||(o[3]=a=>s(e).content=a)},null,512),[[g,s(e).content]])]),t("div",St,[Nt,m(t("textarea",{class:"form-control",id:"spec",placeholder:"\u898F\u683C",row:"10","onUpdate:modelValue":o[4]||(o[4]=a=>s(e).spec=a)},null,512),[[g,s(e).spec]])]),t("div",Mt,[Bt,m(t("input",{type:"number",min:"0",class:"form-control",id:"originPrice","onUpdate:modelValue":o[5]||(o[5]=a=>s(e).origin_price=a)},null,512),[[g,s(e).origin_price,void 0,{number:!0}]])]),t("div",Et,[Ft,m(t("input",{type:"number",min:"0",class:"form-control",id:"price","onUpdate:modelValue":o[6]||(o[6]=a=>s(e).price=a)},null,512),[[g,s(e).price,void 0,{number:!0}]])]),t("div",Tt,[jt,m(t("input",{type:"text",class:"form-control",id:"category","onUpdate:modelValue":o[7]||(o[7]=a=>s(e).category=a)},null,512),[[g,s(e).category]])]),t("div",At,[Dt,m(t("input",{type:"text",class:"form-control",id:"unit","onUpdate:modelValue":o[8]||(o[8]=a=>s(e).unit=a)},null,512),[[g,s(e).unit]])]),t("div",Lt,[t("div",Rt,[m(t("input",{class:"form-check-input",type:"checkbox",id:"isEnabled","onUpdate:modelValue":o[9]||(o[9]=a=>s(e).is_enabled=a)},null,512),[[j,s(e).is_enabled]]),qt])]),t("div",zt,[t("label",Gt,"\u8A55\u50F9 - "+I(s(e).rate),1),m(t("input",{type:"range",class:"form-range w-100",min:"0",max:"5",step:"0.5",id:"rate","onUpdate:modelValue":o[10]||(o[10]=a=>s(e).rate=a)},null,512),[[g,s(e).rate,void 0,{number:!0}]])]),t("div",Kt,[t("div",Ot,[m(t("input",{class:"form-check-input",type:"checkbox",id:"isRateEnabled","onUpdate:modelValue":o[11]||(o[11]=a=>s(e).is_rateEnabled=a)},null,512),[[j,s(e).is_rateEnabled]]),Ht])]),t("div",Jt,[t("button",{type:"submit",class:"btn btn-primary text-white w-100 rounded-pill",disabled:!s(u)},I(s(e).id?"\u7DE8\u8F2F":"\u65B0\u589E"),9,Xt)])])])],32)],40,_t))}},Zt={class:"container pt-4 pb-4 pt-lg-7 pb-lg-7"},Qt={class:"card"},Wt={class:"card-body"},te={class:"d-flex justify-content-md-between pr-3 mb-4"},ee=t("h2",{class:"h6 text-info"},"\u7522\u54C1\u6E05\u55AE",-1),oe={class:"form-check form-switch"},ae=["checked","onChange"],se=["onClick"],le=["onClick"],ne=M(" \u76EE\u524D\u6709 "),ie=M(" \u9805\u7522\u54C1 "),ue={__name:"TheProducts",setup(i){const{toggleLoading:l}=K(),{addNotifications:c}=dt(),_=[{name:"title",label:"\u7522\u54C1\u540D\u7A31"},{name:"category",label:"\u985E\u5225"},{name:"rate",label:"\u8A55\u50F9"},{name:"origin_price",label:"\u539F\u50F9"},{name:"price",label:"\u539F\u50F9"},{name:"is_enabled",label:"\u662F\u5426\u555F\u7528"},{name:"trigger_btn",label:""}],p=N({data:[]}),e=V({currentPage:1,totalPages:1}),f=async(b=1)=>{l(!0);try{const d=await nt(b),{pagination:h,success:v}=d.data,y=d.data.products;v&&(p.data=y.map(r=>T(P({},r),{is_enabled:Boolean(r.is_enabled)})),e.value={currentPage:h.current_page,totalPages:h.total_pages})}catch{}l(!1)},u=V(!1),n=N({data:{}}),o=()=>({title:"",category:"",origin_price:null,price:null,unit:"",description:"",content:"",is_enabled:!0,imageUrl:"",rate:5,imagesUrl:["","","","",""]}),a=async b=>{try{n.data=b,n.data.is_enabled=!n.data.is_enabled,await O({isNew:!1,content:n.data})}catch{}},C=async({id:b})=>{confirm("\u78BA\u8A8D\u522A\u9664"),l(!0);try{(await it(b)).data.success&&f()}catch(d){c({message:d.response.message||"\u7CFB\u7D71\u767C\u751F\u7570\u5E38",type:"danger"})}l(!1)},O=async({isNew:b,content:d})=>{try{l(!0);const h=d.id,v=b?await z({data:d}):await G({id:h,data:{data:d}}),{success:y}=v.data;if(y)if(h){const r=p.findIndex($=>$.id===h);r!==-1&&(p[r]=d)}else f();$vHttpsNotice(v,"\u7522\u54C1\u8ABF\u6574")}catch{$vErrorNotice()}finally{l(!1)}},B=b=>{n.data=b,u.value=!0},H=()=>{u.value=!1,U(),f()},U=()=>{n.data=o()};return U(),f(),(b,d)=>{const h=ct,v=Yt,y=bt;return k(),x("div",Zt,[t("div",Qt,[t("div",Wt,[S(h,{columns:_,values:p.data,pages:e.value,onChangePage:d[1]||(d[1]=r=>f(r))},{header:w(()=>[t("div",te,[ee,t("button",{class:"btn btn-outline-primary shadow-sm py-2",type:"button","aria-controls":"modifyProductItem",onClick:d[0]||(d[0]=r=>B({}))}," \u5EFA\u7ACB\u65B0\u7684\u7522\u54C1 ")])]),is_enabled:w(r=>[t("div",oe,[t("input",{class:"form-check-input",type:"checkbox",checked:r.data.is_enabled,onChange:$=>a(r.data.is_enabled)},null,40,ae)])]),trigger_btn:w(r=>[t("div",null,[t("button",{type:"button",class:"btn btn-sm btn-outline-info me-1","data-action":"remove",onClick:$=>B(r.data)}," \u7DE8\u8F2F ",8,se),t("button",{type:"button",class:"btn btn-sm btn-danger text-white","data-action":"remove",onClick:$=>C({id:r.data.id,title:r.data.title})}," \u522A\u9664 ",8,le)])]),caption:w(()=>[t("p",null,[ne,t("span",null,I(p.data.length),1),ie])]),_:1},8,["values","pages"])])]),S(y,{modelValue:u.value,"onUpdate:modelValue":d[2]||(d[2]=r=>u.value=r),refName:"productModal",title:"\u7522\u54C1"},{default:w(()=>[S(v,{isCreate:Boolean(n.data.id),productItem:n.data,onSubmitProductItem:H,onClearItem:U},null,8,["isCreate","productItem"])]),_:1},8,["modelValue"])])}}};export{ue as default};
